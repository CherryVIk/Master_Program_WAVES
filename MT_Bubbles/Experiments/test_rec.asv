clear all
close all 
clc

a = audioread('recordings/internal_ppfHydIn_15.wav');
X = a(:,1);
%Fs = 5000;%marDeCangas
%Fs = 500000;%whistle
Fs = 192000;
Y = fft(X);
L = length(Y);
% P1 = abs(Y/L);
Y = Y(1:L/2+1); 
logY = 20*log10(abs(Y(:,1))./max(abs(Y(:,1))));

xlen = length(X);
t = (0: xlen-1) / Fs;     
f = Fs*(0:(L/2))/L;
figure
subplot(2,1,1);plot(t,X)
subplot(2,1,2);plot(f,logY) 
title('Single-Sided Amplitude Spectrum of X(t)')
xlabel('f (Hz)')
ylabel('|P1(f)|')
figure
spectrogram(X,1280,1200,1280,Fs,'yaxis');
 saveas(gcf,"internal_ppfHydIn_15"+".png");

%% find at 33-34 s
a = 33; b = 34;
[x, tmin] = min(abs(t-a));
[x, tmax] = min(abs(t-b));
X_range = X(tmin:tmax);
Y_range = fft(X_range);

figure;
subplot(2,1,1);plot(t,X_range)
subplot(2,1,2);plot(f,20*log10(abs(Y_range(:,1))./max(abs(Y_range(:,1))))) 